!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CTFramework=t():e.CTFramework=t()}(this,(()=>(()=>{"use strict";var e={};class t{static render(e,n){const o=e.render();o.component=e,e.vnode=o;const r=t.createDom(o);n.appendChild(r),t.onMount(o)}static scheduleUpdate(e){t.pendingUpdates.push(e),1===t.pendingUpdates.length&&requestAnimationFrame(t.processUpdates)}static processUpdates(){for(;t.pendingUpdates.length;){const e=t.pendingUpdates.shift();e&&e()}}static rerender(e){var n,o;if(!e.vnode)return;const r=e.vnode;if(!e.shouldComponentUpdate(e.props,e.state))return;const d=e.render();d.component=e;const s=t.updateDom(r,d);"string"!=typeof r&&s!==r.dom&&r.dom&&(null===(o=null===(n=r.dom)||void 0===n?void 0:n.parentNode)||void 0===o||o.replaceChild(s,r.dom)),e.vnode=d,e.componentOnUpdate(e.props,e.state)}static createDom(e){if("string"==typeof e||"number"==typeof e)return document.createTextNode(String(e));if("function"==typeof e.tag){const n=new(0,e.tag)(e.props),o=n.render();o.component=n,e.component=n,n.vnode=o;const r=t.createDom(o);return e.dom=r,n.componentOnMount(),r}const n=document.createElement(e.tag);return e.dom=n,n.setAttribute("data-event-id",`${Math.random()}`),t.eventHandlers[n.getAttribute("data-event-id")]=e.props.onClick,t.updateDomProperties(n,{},e.props),e.children.forEach((e=>{const o=t.createDom(e);n.appendChild(o)})),n}static updateDom(e,n){if("string"==typeof e||"string"==typeof n){const t=("string"==typeof n?n:"")||"";return e!==t?document.createTextNode(t):"string"==typeof e?document.createTextNode(e):e.dom}if(e.isStatic)return n.dom=e.dom,n.component=e.component,n.dom;if(e.tag!==n.tag){const o=t.createDom(n);return e.dom&&e.dom.parentNode&&e.dom.parentNode.replaceChild(o,e.dom),o}const o=e.dom;n.dom=o,1===n.children.length&&"string"==typeof n.children[0]&&o.textContent!==n.children[0]&&(o.textContent=n.children[0]),t.updateDomProperties(o,e.props,n.props);const r=e.children||[],d=n.children||[];if(0===r.length&&0===d.length)return t.createDom(n);const s=new Map;return r.forEach((e=>{e&&"string"!=typeof e&&e.key&&s.set(e.key,e)})),d.forEach(((e,n)=>{if("string"==typeof e){const t=e||"",d=r[n];"string"==typeof d&&d!==t?o.childNodes[n].textContent=t:o.childNodes[n]?o.replaceChild(document.createTextNode(t),o.childNodes[n]):o.appendChild(document.createTextNode(t))}else{const d=e.key,c=d?s.get(d):r[n];if(c){const r=t.updateDom(c,e);o.childNodes[n]!==r&&o.replaceChild(r,o.childNodes[n]),d&&s.delete(d)}else{const n=t.createDom(e);o.appendChild(n)}}})),s.forEach((e=>{e.dom&&o.contains(e.dom)&&o.removeChild(e.dom)})),o}static updateDomProperties(e,n,o){t.getPropChanges(n,o).forEach((({name:r,value:d})=>{if("style"===r)t.updateStyle(e,n.style,o.style);else if(r.startsWith("on")){const t=r.toLowerCase().substring(2);e.removeEventListener(t,n[r]),e.addEventListener(t,d)}else"textContent"===r?e.textContent=d:r in e?e[r]=d:e.setAttribute(r,d)}))}static getPropChanges(e,t){const n=[];for(const o in t)t[o]!==e[o]&&n.push({name:o,value:t[o]});return n}static updateStyle(e,t={},n={}){"string"==typeof t||"string"==typeof n?e.setAttribute("style",n||""):(Object.keys(t).forEach((t=>{t in n||(e.style[t]="")})),Object.keys(n).forEach((o=>{t[o]!==n[o]&&(e.style[o]=n[o])})))}static onMount(e){"string"!=typeof e&&(e.component&&e.component.componentOnMount(),e.children.forEach((e=>t.onMount(e))))}static onUnmount(e){"string"!=typeof e&&(e.component&&e.component.componentOnUnmount(),e.children.forEach((e=>t.onUnmount(e))))}}return t.eventHandlers={},t.pendingUpdates=[],document.addEventListener("click",(e=>{let n=e.target;for(;n&&!n.hasAttribute("data-event-id");)n=n.parentElement;if(n){const o=t.eventHandlers[n.getAttribute("data-event-id")];o&&o(e)}})),e.CTFramework})()));
//# sourceMappingURL=index.min.js.map